{
  "tag": "pretraining",
  "ckpt": "ckpt_best.pt",
  "device": "cuda",
  "val": {
    "ce": 1.8621342122554778,
    "ppl": 6.437461029202909,
    "eval_batches": 20,
    "batch_size": 8,
    "max_seq_len": 512
  },
  "throughput": {
    "prompt_set": "prompts/instruct_prompts.txt",
    "prompt_text": "Write a short story for kids about a brave teapot who helps a friend.",
    "off": {
      "use_kv_cache": false,
      "iters": 5,
      "prompt_len": 128,
      "max_new_tokens": 128,
      "gen_tokens_mean": 128.0,
      "time_sec_mean": 3.232942920003552,
      "tokens_per_sec": 39.59240950652459
    },
    "on": {
      "use_kv_cache": true,
      "iters": 5,
      "prompt_len": 128,
      "max_new_tokens": 128,
      "gen_tokens_mean": 128.0,
      "time_sec_mean": 2.8176373799680734,
      "tokens_per_sec": 45.428130997272035
    }
  },
  "routing": {
    "router_entropy_mean_per_layer": [
      0.8503069877624512,
      0.9724506139755249,
      0.8774292469024658,
      0.812153160572052,
      0.7290715575218201,
      0.6704006791114807
    ],
    "max_load_per_layer": [
      0.2939453125,
      0.312255859375,
      0.259033203125,
      0.2696533203125,
      0.290771484375,
      0.2808837890625
    ],
    "load_frac_per_layer": [
      [
        0.250732421875,
        0.2218017578125,
        0.2939453125,
        0.2335205078125
      ],
      [
        0.312255859375,
        0.2972412109375,
        0.1981201171875,
        0.1923828125
      ],
      [
        0.2503662109375,
        0.2347412109375,
        0.255859375,
        0.259033203125
      ],
      [
        0.2568359375,
        0.2257080078125,
        0.247802734375,
        0.2696533203125
      ],
      [
        0.228759765625,
        0.2469482421875,
        0.2335205078125,
        0.290771484375
      ],
      [
        0.2718505859375,
        0.2808837890625,
        0.2418212890625,
        0.2054443359375
      ]
    ],
    "importance_per_layer": [
      [
        0.2823825776576996,
        0.22830480337142944,
        0.24460405111312866,
        0.2447085827589035
      ],
      [
        0.27311232686042786,
        0.25395944714546204,
        0.2572653889656067,
        0.2156628519296646
      ],
      [
        0.24816226959228516,
        0.22814613580703735,
        0.2693016529083252,
        0.2543899416923523
      ],
      [
        0.2376958429813385,
        0.20579783618450165,
        0.29493817687034607,
        0.2615681290626526
      ],
      [
        0.23976606130599976,
        0.24738410115242004,
        0.2441750019788742,
        0.2686748504638672
      ],
      [
        0.2108045518398285,
        0.3211001753807068,
        0.23618027567863464,
        0.23191499710083008
      ]
    ],
    "usage_counts_per_layer": [
      [
        2054.0,
        1817.0,
        2408.0,
        1913.0
      ],
      [
        2558.0,
        2435.0,
        1623.0,
        1576.0
      ],
      [
        2051.0,
        1923.0,
        2096.0,
        2122.0
      ],
      [
        2104.0,
        1849.0,
        2030.0,
        2209.0
      ],
      [
        1874.0,
        2023.0,
        1913.0,
        2382.0
      ],
      [
        2227.0,
        2301.0,
        1981.0,
        1683.0
      ]
    ]
  }
}
